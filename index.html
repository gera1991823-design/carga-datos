<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carga de datos - Interagrovial</title>

<style>
:root{
  --jd-green:#367c2b;
  --jd-yellow:#ffde00;
  --bg:#f6f7f9;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --border:#e5e7eb;
  --shadow:0 10px 30px rgba(2,6,23,.06);
  --radius:16px;
}

*{box-sizing:border-box}
body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  margin:20px;
  background:var(--bg);
  color:var(--text);
}

.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:16px;
}
.title{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:22px;
  font-weight:800;
}
.brandDot{
  width:14px;height:14px;border-radius:50%;
  background:var(--jd-green);
  box-shadow:inset 0 0 0 3px var(--jd-yellow);
}
.subpill{
  background:#fff;
  border:1px solid var(--border);
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
}
.subpill b{color:var(--jd-green)}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
  margin-bottom:16px;
}
.accentBar{
  height:5px;
  background:linear-gradient(90deg,var(--jd-green),var(--jd-yellow));
  border-radius:999px;
  margin:-16px -16px 14px;
}
h3{
  margin:0 0 10px;
  font-size:13px;
  text-transform:uppercase;
  color:#334155;
}

.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:end;
}
label{
  font-size:12px;
  font-weight:600;
  margin-bottom:6px;
  display:block;
}
input,select{
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  font-size:14px;
  min-width:150px;
}
input:focus,select:focus{
  outline:none;
  border-color:var(--jd-green);
  box-shadow:0 0 0 4px rgba(54,124,43,.15);
}

button{
  padding:10px 14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#fff;
  cursor:pointer;
  font-weight:700;
}
button.primary{
  background:var(--jd-green);
  color:#fff;
  border-color:var(--jd-green);
}
button.secondary{
  color:var(--jd-green);
  border-color:var(--jd-green);
}
button.danger{
  color:#b00020;
  border-color:#fecdd3;
}
button.small{padding:6px 10px;font-size:12px}

table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  background:#fff;
  border-radius:var(--radius);
  overflow:hidden;
  box-shadow:var(--shadow);
}
th,td{
  padding:10px;
  border-bottom:1px solid #eee;
  font-size:14px;
  white-space:nowrap;
}
th{
  font-size:12px;
  text-transform:uppercase;
  background:#fff;
}
tbody tr:nth-child(odd){background:#fafafa}
tbody tr:hover{background:#f2f7f2}

.actions{display:flex;gap:6px}

.toast{
  margin-top:10px;
  font-weight:700;
  color:var(--jd-green);
  display:none;
}
.toast.err{color:#b00020}

.footer{
  position:fixed;
  bottom:12px;
  left:16px;
  background:#fff;
  padding:8px 12px;
  border-radius:12px;
  border-left:6px solid var(--jd-green);
  box-shadow:var(--shadow);
  font-size:12px;
}
.footer b{color:var(--jd-green)}
</style>
</head>

<body>

<div class="topbar">
  <div class="title"><span class="brandDot"></span>Carga de datos</div>
  <div class="subpill">Sistema <b>Interagrovial</b></div>
</div>

<div class="card">
  <div class="accentBar"></div>
  <h3>Agregar fila</h3>
  <div class="row">
    <div><label>Factura</label><input id="factura"></div>
    <div><label>División</label><input id="division"></div>
    <div><label>Transporte</label><input id="transporte"></div>
    <div><label>Carpeta</label><input id="carpeta"></div>
    <div><label>Fecha estimada</label><input id="fecha" type="date"></div>
    <div><label>Orden compra</label><input id="oc"></div>
    <div><label>Condiciones</label><select id="cond"><option>SI</option><option>NO</option></select></div>
    <div><label>WIS</label><select id="wis"><option>SI</option><option>NO</option></select></div>
    <button id="add" class="primary">Agregar</button>
  </div>
  <div id="toast" class="toast"></div>
</div>

<table>
<thead>
<tr>
<th>Fecha</th><th>Factura</th><th>División</th><th>Transporte</th>
<th>Carpeta</th><th>Fecha estimada</th><th>OC</th>
<th>Cond.</th><th>WIS</th><th>Acciones</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<div class="footer"><b>INTERAGROVIAL S.A</b></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
import {
  getFirestore, collection, addDoc, onSnapshot,
  deleteDoc, updateDoc, doc, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "carpetas-17846.firebaseapp.com",
  projectId: "carpetas-17846",
  storageBucket: "carpetas-17846.appspot.com",
  messagingSenderId: "TU_SENDER_ID",
  appId: "TU_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const $ = id => document.getElementById(id);
const tbody = $("tbody");
const toast = $("toast");

function showToast(msg, err=false){
  toast.textContent = msg;
  toast.className = "toast" + (err?" err":"");
  toast.style.display = "block";
  setTimeout(()=>toast.style.display="none",2500);
}

$("add").onclick = async ()=>{
  try{
    await addDoc(collection(db,"rows"),{
      factura:$("factura").value,
      division:$("division").value,
      transporte:$("transporte").value,
      carpeta:$("carpeta").value,
      fecha:$("fecha").value,
      oc:$("oc").value,
      cond:$("cond").value,
      wis:$("wis").value,
      created:serverTimestamp()
    });
    showToast("Agregado con éxito");
  }catch(e){
    showToast("Error al guardar",true);
  }
};

onSnapshot(collection(db,"rows"), snap=>{
  tbody.innerHTML="";
  snap.forEach(d=>{
    const r=d.data();
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${r.created?.toDate?.().toLocaleString()||""}</td>
      <td>${r.factura||""}</td>
      <td>${r.division||""}</td>
      <td>${r.transporte||""}</td>
      <td>${r.carpeta||""}</td>
      <td>${r.fecha||""}</td>
      <td>${r.oc||""}</td>
      <td>${r.cond||""}</td>
      <td>${r.wis||""}</td>
      <td class="actions">
        <button class="small danger">Eliminar</button>
      </td>`;
    tr.querySelector("button").onclick=()=>deleteDoc(doc(db,"rows",d.id));
    tbody.appendChild(tr);
  });
});
</script>
</body>
</html>
